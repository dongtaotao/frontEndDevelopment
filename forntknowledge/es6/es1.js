1.5ä¸‡å­—æ¦‚æ‹¬ES6å…¨éƒ¨ç‰¹æ€§(å·²æ›´æ–°ES2020) 
https://juejin.cn/post/6844903959283367950 

ðŸ”¥èŠ±ä¸€ä¸ªå°æ—¶ï¼Œè¿…é€Ÿäº†è§£ES6~ES12çš„å…¨éƒ¨ç‰¹æ€§
https://juejin.cn/post/7068935394191998990?utm_source=gold_browser_extension


async/awaitä¼˜ç‚¹ï¼š
å®ƒåšåˆ°çœŸæ­£çš„ä¸²è¡Œçš„åŒæ­¥å†™æ³•ï¼Œä»£ç é˜…è¯»æ›´ç®€å•
å¯¹äºŽæ¡ä»¶è¯­å¥å’Œå…¶ä»–æµç¨‹æ¯”è¾ƒå‹å¥½ï¼Œå¯ä»¥ç›´æŽ¥å†™åˆ°åˆ¤æ–­æ¡ä»¶

async/awaitç¼ºç‚¹ï¼š
æ— æ³•å¤„ç†promiseè¿”å›žå¯¹è±¡çš„rejectå¯¹è±¡ï¼Œè¦å€ŸåŠ©try...catch...
ç”¨awaitå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºawaitä¼šé˜»å¡žä»£ç ï¼Œä¹‹åŽçš„ä»£ç ä¹Ÿè®¸ä¸ä¾èµ–äºŽå‰è€…ï¼Œä½†ä»ç„¶éœ€è¦ç­‰å¾…å‰è€…çš„å®Œæˆï¼Œ
å¯¼è‡´ä»£ç å¤±åŽ»å¹¶å‘æ€§ã€‚
try...catch...å†…éƒ¨çš„å˜é‡æ— æ³•ä¼ é€’ç»™ä¸‹ä¸€ä¸ªtry...catchPromiseå’Œthen/catchå†…éƒ¨å®šä¹‰çš„å˜é‡

promise
ä¸€æ—¦æ‰§è¡Œï¼Œå°±æ— æ³•ä¸­é€”å–æ¶ˆï¼Œé“¾å¼è°ƒç”¨å¤šä¸ªthenä¸èƒ½éšä¾¿è·³å‡ºæ¥
é”™è¯¯æ— æ³•åœ¨å¤–éƒ¨æ•æ‰ï¼Œåªèƒ½åœ¨å†…éƒ¨é¢„åˆ¤å¤„ç†ï¼Œå¦‚æžœå†…éƒ¨è¿›è¡Œé¢„åˆ¤å¤„ç†ï¼Œå¦‚æžœä¸è®¾ç½®å›žè°ƒå‡½æ•°ï¼Œ
Promiseå†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸èƒ½ååº”åˆ°å¤–éƒ¨
Promiseå†…éƒ¨å¦‚ä½•æ‰§è¡Œï¼Œæ£€æµ‹å¾ˆéš¾ï¼Œå½“å¤„äºŽpendingçŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µ

5. ç®€è¿°ä¸€ä¸‹Promiseï¼Œasync&awaitä¸¤è€…è€…çš„åŒºåˆ«ï¼Ÿ
promiseé€šè¿‡é“¾å¼è°ƒç”¨ï¼Œç›´æŽ¥åœ¨thenä¸­è¿”å›žä¸€ä¸ªpromiseæ¥è¿›è¡ŒæˆåŠŸä¹‹åŽçš„å›žè°ƒå‡½æ•°ï¼Œç”¨catchæ¥åšé”™è¯¯å¤„ç†
asyncæ˜¯Generatorå‡½æ•°çš„è¯­æ³•ç³–ï¼Œasync/awaitåˆ™å°†å…¶å˜æˆåŒæ­¥çš„å†™æ³•ï¼Œå³å¯ä»¥ç”¨try-catchæ•èŽ·ï¼Œç®€æ´ï¼Œ
å¯è¯»æ€§æ›´é«˜ï¼Œå†™æ³•æ›´ä¼˜é›…

6. CommonJSå’ŒES6æ¨¡å—çš„åŒºåˆ«
CommonJSæ¨¡å—è¾“å‡ºæ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ˆæµ…æ‹·è´ï¼‰ï¼ŒES6æ¨¡å—è¾“å‡ºæ˜¯å€¼çš„å¼•ç”¨
CommonJSæ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæŽ¥å£
CommonJSæ¨¡å—çš„require()æ˜¯åŒæ­¥åŠ è½½æ¨¡å—ï¼ŒES6æ¨¡å—çš„importå‘½ä»¤æ˜¯å¼‚æ­¥åŠ è½½ï¼Œæœ‰ä¸€ä¸ªç‹¬ç«‹ä¾èµ–çš„è§£æžæ¨¡å—é˜¶æ®µ

1. è¯·ç®€è¿°ä¸‹promiseçš„ä¼˜ç¼ºç‚¹ï¼Ÿ
ç¼ºç‚¹ï¼š
æ— æ³•å–æ¶ˆPromiseï¼Œä¸€æ—¦æ–°å»ºå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆ
å¦‚æžœä¸è®¾ç½®å›žè°ƒå‡½æ•°ï¼Œpromiseå†…éƒ¨æŠ›å‡ºçš„é”™è¯¯å°±æ— æ³•ååº”åˆ°å¤–éƒ¨
å½“å¤„äºŽpendingçŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰

ä¼˜ç‚¹ï¼š
è§£å†³å›žè°ƒåœ°ç‹±é—®é¢˜
ä»£ç æ‰å¹³å¯è¯»ï¼Œ.thenæ–¹æ³•é“¾å¼è°ƒç”¨
æ›´å¥½çš„è¿›è¡Œé”™è¯¯æ•èŽ·

promise.anyï¼š
ä¹Ÿæ˜¯åŒæ—¶å¤„ç†promiseå®žä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„promiseå®žä¾‹ã€‚
å®ƒçš„çŠ¶æ€å˜åŒ–è·Ÿpromise.raceç±»ä¼¼ï¼Œåªè¦å‚æ•°å®žä¾‹æœ‰ä¸€ä¸ªå˜æˆfulfilledçŠ¶æ€ï¼ŒåŒ…è£…å®žä¾‹å°±ä¼šå˜æˆfulfilledçŠ¶æ€
å¦‚æžœæ‰€æœ‰å‚æ•°å®žä¾‹éƒ½å˜æˆrejectedçŠ¶æ€ï¼ŒåŒ…è£…å®žä¾‹å°±ä¼šå˜æˆrejectedçŠ¶æ€ã€‚
å’Œpromise.race()ä¸åŒç‚¹ï¼Œå°±æ˜¯promise.any()ä¸ä¼šå› ä¸ºæŸä¸ªpromiseå˜æˆrejectedçŠ¶æ€è€Œç»“æŸï¼Œ
å¿…é¡»è¦ç­‰åˆ°æ‰€æœ‰çš„å‚æ•°promiseå˜æˆrejectedçŠ¶æ€æ‰ç»“æŸ

Promise.any();æœ‰ä¸€ä¸ªå­å®žä¾‹æˆåŠŸå°±ç®—æˆåŠŸï¼Œå…¨éƒ¨å­å®žä¾‹å¤±è´¥æ‰ç®—å¤±è´¥ï¼›
Promise.all()ï¼›å…¨éƒ¨å­å®žä¾‹çš„æˆåŠŸæ‰ç®—æˆåŠŸï¼Œä¸€ä¸ªå­å®žä¾‹å¤±è´¥å°±ç®—å¤±è´¥ï¼›
Promise.race()ï¼›receæ˜¯èµ›è·‘æœºåˆ¶ï¼Œçœ‹æœ€å…ˆçš„promiseå­å®žä¾‹æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚

let resolved = Promise.resolve(2);
let resolved1 = Promise.resolve(5);
let rejected = Promise.reject(-1);
const allSettledPromise = Promise.any([resolved1,resolved, rejected]);
allSettledPromise.then(function (results) {
  console.log(results);
});

let promise1 = new Promise((resolve,reject) => {
	setTimeout(() =>  {
    reject(1);
	},2000)
});
let promise2 = new Promise((resolve,reject) => {
	setTimeout(() => {
    resolve(2);
	},1000)
});
let promise3 = new Promise((resolve,reject) => {
	setTimeout(() => {
    resolve(3);
	},3000)
});
Promise.race([promise1,promise2,promise3]).then(res => {
	console.log(res); //ç»“æžœï¼š2
},rej => {
  console.log(rej)};
)

äºŒã€Promise.raceçš„ä½¿ç”¨
é¡¾åæ€ä¹‰ï¼ŒPromse.raceå°±æ˜¯èµ›è·‘çš„æ„æ€ï¼Œæ„æ€å°±æ˜¯è¯´ï¼ŒPromise.race([p1, p2, p3])é‡Œé¢å“ªä¸ªç»“æžœèŽ·å¾—çš„å¿«ï¼Œå°±è¿”å›žé‚£ä¸ªç»“æžœï¼Œä¸ç®¡ç»“æžœ
æœ¬èº«æ˜¯æˆåŠŸçŠ¶æ€è¿˜æ˜¯å¤±è´¥çŠ¶æ€ã€‚

let p1 = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('success')
  },1000)
})

let p2 = new Promise((resolve, reject) => {
  setTimeout(() => {
    reject('failed')
  }, 500)
})

Promise.race([p1, p2]).then((result) => {
  console.log(result)
}).catch((error) => {
  console.log(error)  // æ‰“å¼€çš„æ˜¯ 'failed'
})

1. Generator æ¦‚è¿°
1ï¼‰Generator
Generatorï¼ˆç”Ÿæˆå™¨ï¼‰æ˜¯ ES6 ä¸­çš„å…³é”®è¯ï¼Œé€šä¿—æ¥è®² Generator æ˜¯ä¸€ä¸ªå¸¦æ˜Ÿå·çš„å‡½æ•°ï¼ˆå®ƒå¹¶ä¸æ˜¯çœŸæ­£çš„å‡½æ•°ï¼‰ï¼Œ
å¯ä»¥é…åˆ yield å…³é”®å­—æ¥æš‚åœæˆ–è€…æ‰§è¡Œå‡½æ•°ã€‚å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š
function* gen() {
  console.log("enter");
  let a = yield 1;
  let b = yield (function () {return 2})();
  return 3;
}
var g = gen()           // é˜»å¡žï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•è¯­å¥
console.log(typeof g)   // è¿”å›ž object è¿™é‡Œä¸æ˜¯ "function"
console.log(g.next())
console.log(g.next())
console.log(g.next())
console.log(g.next()) 

object
enter
{ value: 1, done: false }
{ value: 2, done: false }
{ value: 3, done: true }
{ value: undefined, done: true }
https://juejin.cn/post/6995357238277701668

Promiseçš„ç†è§£
Promiseæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥èŽ·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ï¼Œ
ä»–çš„å‡ºçŽ°å¤§å¤§æ”¹å–„äº†å¼‚æ­¥ç¼–ç¨‹çš„å›°å¢ƒï¼Œé¿å…äº†åœ°ç‹±å›žè°ƒï¼Œå®ƒæ¯”ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆå›žè°ƒå‡½æ•°å’Œäº‹ä»¶æ›´åˆç†å’Œæ›´å¼ºå¤§ã€‚
æ‰€è°“Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æžœã€‚
ä»Žè¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»Žå®ƒå¯ä»¥èŽ·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚Promise æä¾›ç»Ÿä¸€çš„ APIï¼Œ
å„ç§å¼‚æ­¥æ“ä½œéƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚
ï¼ˆ1ï¼‰Promiseçš„å®žä¾‹æœ‰ä¸‰ä¸ªçŠ¶æ€:
Pendingï¼ˆè¿›è¡Œä¸­ï¼‰
Resolvedï¼ˆå·²å®Œæˆï¼‰
Rejectedï¼ˆå·²æ‹’ç»ï¼‰
å½“æŠŠä¸€ä»¶äº‹æƒ…äº¤ç»™promiseæ—¶ï¼Œå®ƒçš„çŠ¶æ€å°±æ˜¯Pendingï¼Œä»»åŠ¡å®Œæˆäº†çŠ¶æ€å°±å˜æˆäº†Resolvedã€
æ²¡æœ‰å®Œæˆå¤±è´¥äº†å°±å˜æˆäº†Rejectedã€‚
ï¼ˆ2ï¼‰Promiseçš„å®žä¾‹æœ‰ä¸¤ä¸ªè¿‡ç¨‹ï¼š
pending -> fulfilled : Resolvedï¼ˆå·²å®Œæˆï¼‰
pending -> rejectedï¼šRejectedï¼ˆå·²æ‹’ç»ï¼‰
æ³¨æ„ï¼šä¸€æ—¦ä»Žè¿›è¡ŒçŠ¶æ€å˜æˆä¸ºå…¶ä»–çŠ¶æ€å°±æ°¸è¿œä¸èƒ½æ›´æ”¹çŠ¶æ€äº†ã€‚
Promiseçš„ç‰¹ç‚¹ï¼š

å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“ã€‚promiseå¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œ
æœ‰ä¸‰ç§çŠ¶æ€ï¼Œpendingï¼ˆè¿›è¡Œä¸­ï¼‰ã€fulfilledï¼ˆå·²æˆåŠŸï¼‰ã€rejectedï¼ˆå·²å¤±è´¥ï¼‰ã€‚
åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æžœï¼Œå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ï¼Œ
è¿™ä¹Ÿæ˜¯promiseè¿™ä¸ªåå­—çš„ç”±æ¥â€”â€”â€œæ‰¿è¯ºâ€ï¼›
ä¸€æ—¦çŠ¶æ€æ”¹å˜å°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æžœã€‚promiseå¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œ
åªæœ‰ä¸¤ç§å¯èƒ½ï¼šä»Žpendingå˜ä¸ºfulfilledï¼Œä»Žpendingå˜ä¸ºrejectedã€‚è¿™æ—¶å°±ç§°ä¸ºresolvedï¼ˆå·²å®šåž‹ï¼‰ã€‚
å¦‚æžœæ”¹å˜å·²ç»å‘ç”Ÿäº†ï¼Œä½ å†å¯¹promiseå¯¹è±¡æ·»åŠ å›žè°ƒå‡½æ•°ï¼Œä¹Ÿä¼šç«‹å³å¾—åˆ°è¿™ä¸ªç»“æžœã€‚è¿™ä¸Žäº‹ä»¶ï¼ˆeventï¼‰å®Œå…¨ä¸åŒï¼Œ
äº‹ä»¶çš„ç‰¹ç‚¹æ˜¯ï¼šå¦‚æžœä½ é”™è¿‡äº†å®ƒï¼Œå†åŽ»ç›‘å¬æ˜¯å¾—ä¸åˆ°ç»“æžœçš„ã€‚

Promiseçš„ç¼ºç‚¹ï¼š
æ— æ³•å–æ¶ˆPromiseï¼Œä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆã€‚
å¦‚æžœä¸è®¾ç½®å›žè°ƒå‡½æ•°ï¼ŒPromiseå†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šååº”åˆ°å¤–éƒ¨ã€‚
å½“å¤„äºŽpendingçŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰ã€‚

æ€»ç»“ï¼š
Promise å¯¹è±¡æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæœ€æ—©ç”±ç¤¾åŒºæå‡ºã€‚Promise æ˜¯ä¸€ä¸ªæž„é€ å‡½æ•°ï¼Œ
æŽ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å›žä¸€ä¸ª Promise å®žä¾‹ã€‚ä¸€ä¸ª Promise å®žä¾‹æœ‰ä¸‰ç§çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯pendingã€resolved å’Œ rejectedï¼Œåˆ†åˆ«ä»£è¡¨äº†è¿›è¡Œä¸­ã€
å·²æˆåŠŸå’Œå·²å¤±è´¥ã€‚å®žä¾‹çš„çŠ¶æ€åªèƒ½ç”± pending è½¬å˜ resolved æˆ–è€…rejected çŠ¶æ€ï¼Œå¹¶ä¸”çŠ¶æ€ä¸€ç»æ”¹å˜ï¼Œå°±å‡å›ºäº†ï¼Œæ— æ³•å†è¢«æ”¹å˜äº†ã€‚

7.  å¯¹async/await çš„ç†è§£
async/awaitå…¶å®žæ˜¯Generator çš„è¯­æ³•ç³–ï¼Œ
å®ƒèƒ½å®žçŽ°çš„æ•ˆæžœéƒ½èƒ½ç”¨thené“¾æ¥å®žçŽ°ï¼Œå®ƒæ˜¯ä¸ºä¼˜åŒ–thené“¾è€Œå¼€å‘å‡ºæ¥çš„ã€‚
ä»Žå­—é¢ä¸Šæ¥çœ‹ï¼Œasyncæ˜¯â€œå¼‚æ­¥â€çš„ç®€å†™ï¼Œawaitåˆ™ä¸ºç­‰å¾…ï¼Œæ‰€ä»¥å¾ˆå¥½ç†è§£async
ç”¨äºŽç”³æ˜Žä¸€ä¸ª function æ˜¯å¼‚æ­¥çš„ï¼Œè€Œ await ç”¨äºŽç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæˆã€‚
å½“ç„¶è¯­æ³•ä¸Šå¼ºåˆ¶è§„å®šawaitåªèƒ½å‡ºçŽ°åœ¨asnycå‡½æ•°ä¸­ï¼Œå…ˆæ¥çœ‹çœ‹asyncå‡½æ•°è¿”å›žäº†ä»€ä¹ˆï¼š

10. async/awaitå¯¹æ¯”Promiseçš„ä¼˜åŠ¿
ä»£ç è¯»èµ·æ¥æ›´åŠ åŒæ­¥ï¼ŒPromiseè™½ç„¶æ‘†è„±äº†å›žè°ƒåœ°ç‹±ï¼Œä½†æ˜¯thençš„é“¾å¼è°ƒâ½¤ä¹Ÿä¼šå¸¦æ¥é¢å¤–çš„é˜…è¯»è´Ÿæ‹…
Promiseä¼ é€’ä¸­é—´å€¼â¾®å¸¸éº»çƒ¦ï¼Œâ½½async/awaitâ¼ä¹Žæ˜¯åŒæ­¥çš„å†™æ³•ï¼Œâ¾®å¸¸ä¼˜é›…
é”™è¯¯å¤„ç†å‹å¥½ï¼Œasync/awaitå¯ä»¥â½¤æˆç†Ÿçš„try/catchï¼ŒPromiseçš„é”™è¯¯æ•èŽ·â¾®å¸¸å†—ä½™
è°ƒè¯•å‹å¥½ï¼ŒPromiseçš„è°ƒè¯•å¾ˆå·®ï¼Œç”±äºŽæ²¡æœ‰ä»£ç å—ï¼Œä½ ä¸èƒ½åœ¨â¼€ä¸ªè¿”å›žè¡¨è¾¾å¼çš„ç®­å¤´å‡½æ•°ä¸­è®¾ç½®æ–­ç‚¹ï¼Œ
å¦‚æžœä½ åœ¨â¼€ä¸ª.thenä»£ç å—ä¸­ä½¿â½¤è°ƒè¯•å™¨çš„æ­¥è¿›(step-over)åŠŸèƒ½ï¼Œè°ƒè¯•å™¨å¹¶ä¸ä¼šè¿›â¼ŠåŽç»­çš„.thenä»£ç å—ï¼Œ
å› ä¸ºè°ƒè¯•å™¨åªèƒ½è·Ÿè¸ªåŒæ­¥ä»£ç çš„æ¯â¼€æ­¥ã€‚

é¦–å…ˆ requestAnimationFrame è‡ªå¸¦å‡½æ•°èŠ‚æµåŠŸèƒ½ï¼ŒåŸºæœ¬å¯ä»¥ä¿è¯åœ¨ 16.6 æ¯«ç§’å†…åªæ‰§è¡Œä¸€æ¬¡ï¼ˆä¸æŽ‰å¸§çš„æƒ…
å†µä¸‹ï¼‰ï¼Œå¹¶ä¸”è¯¥å‡½æ•°çš„å»¶æ—¶æ•ˆæžœæ˜¯ç²¾ç¡®çš„ï¼Œæ²¡æœ‰å…¶ä»–å®šæ—¶å™¨æ—¶é—´ä¸å‡†çš„é—®é¢˜ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡è¯¥å‡½æ•°
æ¥å®žçŽ° setTimeoutã€‚

æ‰‹å†™å®žçŽ°4ç§ç»§æ‰¿
function Father () {}
function Child () {}
// 1\. åŽŸåž‹ç»§æ‰¿
Child.prototype = new Father()
// 2\. æž„é€ ç»§æ‰¿
function Child (name) {
  Father.call(this, name)
}
// 3\. ç»„åˆç»§æ‰¿
function Child (name) {
  Father.call(this, name)
}
Child.prototype = new Father()
// 4\. å¯„ç”Ÿç»§æ‰¿
function cloneObj (o) {
  var clone = object.create(o)
  clone.sayName = ...
  return clone
}
// 5\. å¯„ç”Ÿç»„åˆç»§æ‰¿
// 6\. ES6 class extendç»§æ‰¿

asyncå’Œawaitï¼š
Generatorå‡½æ•°çš„è¯­æ³•ç³–ï¼Œå°†*æ”¹æˆasyncï¼Œå°†yieldæ¢æˆawaitã€‚
æ˜¯å¯¹Generatorå‡½æ•°çš„æ”¹è¿›, è¿”å›žpromiseã€‚
å¼‚æ­¥å†™æ³•åŒæ­¥åŒ–ï¼Œé‡åˆ°awaitå…ˆè¿”å›žï¼Œæ‰§è¡Œå®Œå¼‚æ­¥å†æ‰§è¡ŒæŽ¥ä¸‹æ¥çš„
å†…ç½®æ‰§è¡Œå™¨, æ— éœ€next()

promise.finallyå®žçŽ°
Promise.prototype.finally = function (callback) {
  let P = this.constructor;
  return this.then(
    value  => P.resolve(callback()).then(() => value),
    reason => P.resolve(callback()).then(() => { throw reason }) 
  );
};  


Promise.all = (promises) => {
  // ç¬¦åˆæ¡ä»¶3ï¼Œè¿”å›žä¸€ä¸ªPromise
  return new Promise((rs, rj) => {
    let count = 0
    let result = []
    const len = promises.length

    promises.forEach((p, i) => {
      // ç¬¦åˆæ¡ä»¶1ï¼Œå°†æ•°ç»„é‡Œçš„é¡¹é€šè¿‡Promise.resolveè¿›è¡ŒåŒ…è£…
      Promise.resolve(p).then((res) => {
        count += 1
        result[ i ] = res
        // ç¬¦åˆæ¡ä»¶2 ç­‰å¾…æ‰€æœ‰éƒ½å®Œæˆ
        if (count === len) {
          rs(result)
        }
        // ç¬¦åˆæ¡ä»¶2  åªè¦ä¸€ä¸ªå¤±è´¥å°±éƒ½å¤±è´¥
      }).catch(rj)
    })
  })
}


Promise.race = (promises) => {
  // è¿”å›žä¸€ä¸ªæ–°çš„Promise
  return new Promise((rs, rj) => {
    promises.forEach((p) => {
      // åŒ…è£…ä¸€ä¸‹promisesä¸­çš„é¡¹ï¼Œé˜²æ­¢éžPromise .thenå‡ºé”™
      // åªè¦æœ‰ä»»æ„ä¸€ä¸ªå®Œæˆäº†æˆ–è€…æ‹’ç»äº†ï¼Œraceä¹Ÿå°±ç»“æŸäº†
      Promise.resolve(p).then(rs).catch(rj)
    })
  })
}

const promise1 = new Promise((resolve, reject) => {
  setTimeout(resolve, 500, 1);
});

const promise2 = new Promise((resolve, reject) => {
  setTimeout(resolve, 100, 2);
});

Promise.myRace([promise1, promise2]).then((value) => {
  // å› ä¸ºpromise2æ›´å¿«æ‰€ä»¥æ‰“å°å‡º2
  console.log(value) // 2
});

Promise.myRace([promise1, promise2, 3]).then((value) => {
  // 3æ¯”å…¶ä»–ä¸¤ä¸ªæ›´å¿«
  console.log(value) // 3
});


Promise.allSettled
Promise.myAllSettled = (promises) => {
  return new Promise((rs, rj) => {
    let count = 0
    let result = []
    const len = promises.length
    // æ•°ç»„æ˜¯ç©ºçš„è¯ï¼Œç›´æŽ¥è¿”å›žç©ºæ•°æ®
    if (len === 0) {
      return rs([])
    }

    promises.forEach((p, i) => {
      Promise.resolve(p).then((res) => {
        count += 1
        // æˆåŠŸå±žæ€§è®¾ç½® 
        result[ i ] = {
          status: 'fulfilled',
          value: res
        }
        
        if (count === len) {
          rs(result)
        }
      }).catch((err) => {
        count += 1
        // å¤±è´¥å±žæ€§è®¾ç½® 
        result[i] = { 
          status: 'rejected', 
          reason: err 
        }

        if (count === len) {
          rs(result)
        }
      })
    })
  })
}

// æµ‹è¯•ä¸€ä¸‹
const p1 = Promise.resolve(1)
const p2 = new Promise((resolve) => {
  setTimeout(() => resolve(2), 1000)
})
const p3 = new Promise((resolve) => {
  setTimeout(() => resolve(3), 3000)
})

const p4 = Promise.reject('err4')
const p5 = Promise.reject('err5')
// 1. æ‰€æœ‰çš„Promiseéƒ½æˆåŠŸäº†
const p11 = Promise.myAllSettled([ p1, p2, p3 ])
	.then((res) => console.log(JSON.stringify(res, null,  2)))

// è¾“å‡º 
/*
[
  {
    "status": "fulfilled",
    "value": 1
  },
  {
    "status": "fulfilled",
    "value": 2
  },
  {
    "status": "fulfilled",
    "value": 3
  }
]
*/
      
// 2. æœ‰ä¸€ä¸ªPromiseå¤±è´¥äº†
const p12 = Promise.myAllSettled([ p1, p2, p4 ])
	.then((res) => console.log(JSON.stringify(res, null,  2)))
        
// è¾“å‡º 
/*
[
  {
    "status": "fulfilled",
    "value": 1
  },
  {
    "status": "fulfilled",
    "value": 2
  },
  {
    "status": "rejected",
    "reason": "err4"
  }
]
*/
      
// 3. æœ‰ä¸¤ä¸ªPromiseå¤±è´¥äº†
const p13 = Promise.myAllSettled([ p1, p4, p5 ])
	.then((res) => console.log(JSON.stringify(res, null,  2)))
// è¾“å‡º 
/*
[
  {
    "status": "fulfilled",
    "value": 1
  },
  {
    "status": "rejected",
    "reason": "err4"
  },
  {
    "status": "rejected",
    "reason": "err5"
  }
]
*/    
 
 
